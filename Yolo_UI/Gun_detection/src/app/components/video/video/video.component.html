<div class="dashboard-container">
    <header class="dashboard-header">
      <h1>SystÃ¨me de Surveillance et DÃ©tection</h1>
      <div class="status-badge" [ngClass]="{'active': isStreaming}">
        {{ isStreaming ? 'Surveillance active' : 'Surveillance inactive' }}
      </div>
    </header>
  
    <div class="main-content">
      <div class="video-section">
        <div class="video-container">
          <video #video id="video" [width]="WIDTH" [height]="HEIGHT" autoplay></video>
          <canvas #canvas id="canvas" [width]="WIDTH" [height]="HEIGHT" hidden></canvas>
        </div>
        
        <div class="controls">
          <button class="btn primary" (click)="startStreaming()" *ngIf="!isStreaming">
            <span class="icon">â–¶</span> DÃ©marrer la dÃ©tection
          </button>
          <button class="btn danger" (click)="stopStreaming()" *ngIf="isStreaming">
            <span class="icon">â– </span> ArrÃªter la dÃ©tection
          </button>
          <button class="btn secondary" (click)="toggleMute()">
            <span class="icon">{{ isMuted ? 'ðŸ”‡' : 'ðŸ”Š' }}</span> 
            {{ isMuted ? 'Activer le son' : 'DÃ©sactiver le son' }}
          </button>
        </div>
        
        <div class="detection-panel" *ngIf="detections.length > 0">
          <h3>DÃ©tections en cours</h3>
          <ul class="detection-list">
            <li *ngFor="let det of getCurrentDetections()" class="detection-item">
              <div class="detection-info">
                <span class="detection-label">{{ det.class }}</span>
                <div class="confidence-meter">
                  <div class="confidence-bar" [style.width.%]="det.confidence"></div>
                  <span class="confidence-value">{{ det.confidence }}%</span>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
  
      <div class="alerts-section" *ngIf="alerts.length > 0">
        <div class="alerts-header">
          <h2>Alertes de sÃ©curitÃ©</h2>
          <div class="alert-actions">
            <button class="btn warning" (click)="dismissAllAlerts()">Ignorer tout</button>
            <button class="btn danger" (click)="contactAuthorities()">Contacter les forces de l'ordre</button>
          </div>
        </div>
        
        <div class="alerts-container">
          <div class="alert-card" *ngFor="let alert of alerts">
            <div class="alert-header">
              <span class="alert-timestamp">{{ alert.timestamp | date:'dd/MM/yyyy Ã  HH:mm:ss' }}</span>
              <div class="alert-badge">{{ alert.class }} - {{ alert.confidence }}%</div>
            </div>
            
            <div class="alert-image">
              <img [src]="alert.image" alt="DÃ©tection d'arme">
            </div>
            
            <div class="alert-actions">
              <button class="btn small" (click)="dismissAlert(alert)">Ignorer</button>
              <button class="btn small primary" (click)="downloadImage(alert)">TÃ©lÃ©charger</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Ã‰lÃ©ment audio pour l'alerte sonore -->
    <audio #alertSound src="assets/sounds/alerte-bombe-nucleaire.mp3" hidden></audio>
  </div>